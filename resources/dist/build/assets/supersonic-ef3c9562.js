var R=(t,e,i)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)};var g=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function B(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var D="Expected a function",C=0/0,K="[object Symbol]",H=/^\s+|\s+$/g,U=/^[-+]0x[0-9a-f]+$/i,W=/^0b[01]+$/i,q=/^0o[0-7]+$/i,X=parseInt,G=typeof g=="object"&&g&&g.Object===Object&&g,z=typeof self=="object"&&self&&self.Object===Object&&self,J=G||z||Function("return this")(),Q=Object.prototype,Y=Q.toString,Z=Math.max,ee=Math.min,T=function(){return J.Date.now()};function te(t,e,i){var r,a,h,d,c,s,o=0,_=!1,f=!1,l=!0;if(typeof t!="function")throw new TypeError(D);e=L(e)||0,S(i)&&(_=!!i.leading,f="maxWait"in i,h=f?Z(L(i.maxWait)||0,e):h,l="trailing"in i?!!i.trailing:l);function p(n){var u=r,m=a;return r=a=void 0,o=n,d=t.apply(m,u),d}function y(n){return o=n,c=setTimeout(v,e),_?p(n):d}function I(n){var u=n-s,m=n-o,$=e-u;return f?ee($,h-m):$}function b(n){var u=n-s,m=n-o;return s===void 0||u>=e||u<0||f&&m>=h}function v(){var n=T();if(b(n))return w(n);c=setTimeout(v,I(n))}function w(n){return c=void 0,l&&r?p(n):(r=a=void 0,d)}function x(){c!==void 0&&clearTimeout(c),o=0,r=s=a=c=void 0}function A(){return c===void 0?d:w(T())}function V(){var n=T(),u=b(n);if(r=arguments,a=this,s=n,u){if(c===void 0)return y(s);if(f)return c=setTimeout(v,e),p(s)}return c===void 0&&(c=setTimeout(v,e)),d}return V.cancel=x,V.flush=A,V}function ie(t,e,i){var r=!0,a=!0;if(typeof t!="function")throw new TypeError(D);return S(i)&&(r="leading"in i?!!i.leading:r,a="trailing"in i?!!i.trailing:a),te(t,e,{leading:r,maxWait:e,trailing:a})}function S(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function re(t){return!!t&&typeof t=="object"}function ne(t){return typeof t=="symbol"||re(t)&&Y.call(t)==K}function L(t){if(typeof t=="number")return t;if(ne(t))return C;if(S(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=S(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(H,"");var i=W.test(t);return i||q.test(t)?X(t.slice(2),i?2:8):U.test(t)?C:+t}var se=ie;const ae=B(se);var ce="Expected a function",N=0/0,oe="[object Symbol]",le=/^\s+|\s+$/g,ue=/^[-+]0x[0-9a-f]+$/i,de=/^0b[01]+$/i,fe=/^0o[0-7]+$/i,he=parseInt,me=typeof g=="object"&&g&&g.Object===Object&&g,pe=typeof self=="object"&&self&&self.Object===Object&&self,ve=me||pe||Function("return this")(),ge=Object.prototype,_e=ge.toString,Ve=Math.max,ye=Math.min,k=function(){return ve.Date.now()};function be(t,e,i){var r,a,h,d,c,s,o=0,_=!1,f=!1,l=!0;if(typeof t!="function")throw new TypeError(ce);e=M(e)||0,j(i)&&(_=!!i.leading,f="maxWait"in i,h=f?Ve(M(i.maxWait)||0,e):h,l="trailing"in i?!!i.trailing:l);function p(n){var u=r,m=a;return r=a=void 0,o=n,d=t.apply(m,u),d}function y(n){return o=n,c=setTimeout(v,e),_?p(n):d}function I(n){var u=n-s,m=n-o,$=e-u;return f?ye($,h-m):$}function b(n){var u=n-s,m=n-o;return s===void 0||u>=e||u<0||f&&m>=h}function v(){var n=k();if(b(n))return w(n);c=setTimeout(v,I(n))}function w(n){return c=void 0,l&&r?p(n):(r=a=void 0,d)}function x(){c!==void 0&&clearTimeout(c),o=0,r=s=a=c=void 0}function A(){return c===void 0?d:w(k())}function V(){var n=k(),u=b(n);if(r=arguments,a=this,s=n,u){if(c===void 0)return y(s);if(f)return c=setTimeout(v,e),p(s)}return c===void 0&&(c=setTimeout(v,e)),d}return V.cancel=x,V.flush=A,V}function j(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function we(t){return!!t&&typeof t=="object"}function $e(t){return typeof t=="symbol"||we(t)&&_e.call(t)==oe}function M(t){if(typeof t=="number")return t;if($e(t))return N;if(j(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=j(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(le,"");var i=de.test(t);return i||fe.test(t)?he(t.slice(2),i?2:8):ue.test(t)?N:+t}var Se=be;const Ie=B(Se);function O(t,e,i,r,a,h,d,c){var s=typeof t=="function"?t.options:t;e&&(s.render=e,s.staticRenderFns=i,s._compiled=!0),r&&(s.functional=!0),h&&(s._scopeId="data-v-"+h);var o;if(d?(o=function(l){l=l||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!l&&typeof __VUE_SSR_CONTEXT__<"u"&&(l=__VUE_SSR_CONTEXT__),a&&a.call(this,l),l&&l._registeredComponents&&l._registeredComponents.add(d)},s._ssrRegister=o):a&&(o=c?function(){a.call(this,(s.functional?this.parent:this).$root.$options.shadowRoot)}:a),o)if(s.functional){s._injectStyles=o;var _=s.render;s.render=function(p,y){return o.call(y),_(p,y)}}else{var f=s.beforeCreate;s.beforeCreate=f?[].concat(f,o):[o]}return{exports:t,options:s}}const xe={props:{actions:{type:Object,required:!0},isVisible:{type:Boolean,required:!0},mode:{type:String,required:!0}},data(){return{mainView:{filterVal:"",filteredActions:{},selectedIdx:0},searchView:{searchVal:"",customErrorMessage:"",errorSearching:!1,searchResults:[],selectedIdx:0,isSearching:!1,searchUrl:""}}},mounted(){this.debouncedFilter=ae(()=>{this.filter()},100),this.debouncedSearch=Ie(()=>{this.search()},300),this.filter()},beforeUnmount(){this.debouncedFilter.cancel()},watch:{"mainView.filterVal"(){this.debouncedFilter()},"searchView.searchVal"(){this.debouncedSearch()}},methods:{filter(){this.mainView.filteredActions={};var t=this.mainView.filterVal.toLowerCase(),e=!1,i=0;this.mainView.selectedIdx=0;for(var r in this.actions)this.actions[r].searchName.includes(t)&&(this.mainView.filteredActions[i]=Object.assign({isSelected:!e,...this.actions[r]}),e=e||this.mainView.filteredActions[i].isSelected,i++)},async search(){this.searchView.isSearching=!0,this.searchView.errorSearching=!1,this.searchView.searchResults=[],this.searchView.searchVal.toLowerCase();const t=await fetch(this.searchView.searchUrl+"?"+new URLSearchParams({s:this.searchView.searchVal})).then(e=>(this.searchView.selectedIdx=0,e.ok?e.json():(this.searchView.customErrorMessage="",e.headers.has("x-supersonic-error")&&(this.searchView.customErrorMessage=e.headers.get("x-supersonic-error")),this.searchView.errorSearching=!0,[]))).catch(e=>(this.searchView.errorSearching=!0,[]));this.searchView.searchResults=await t,this.searchView.searchResults.length>0&&(this.searchView.searchResults.isSelected=!0),this.searchView.isSearching=!1},toggleVisibility(){this.isVisible||(this.mainView.filterVal="",this.mode="main"),this.isVisible=!this.isVisible,this.isVisible&&Vue.nextTick(()=>{document.getElementById("supersonic-filter").focus()})},visibilityHide(){this.isVisible=!1},mainSelectNext(){this.mainView.selectedIdx+1<Object.keys(this.mainView.filteredActions).length&&this.mainView.selectedIdx++,document.getElementById("action-"+this.mainView.selectedIdx).scrollIntoView({block:"center"})},mainSelectPrevious(){this.mainView.selectedIdx>0&&this.mainView.selectedIdx--,document.getElementById("action-"+this.mainView.selectedIdx).scrollIntoView({block:"center"})},leaveSearchAction(){this.mode="main"},selectNextSearchResult(){this.searchView.selectedIdx+1<this.searchView.searchResults.length&&this.searchView.selectedIdx++,document.getElementById("action-"+this.searchView.selectedIdx).scrollIntoView({block:"center"})},selectPreviousSearchResult(){this.searchView.selectedIdx>0&&this.searchView.selectedIdx--,document.getElementById("action-"+this.searchView.selectedIdx).scrollIntoView({block:"center"})},doAction(t){var r,a;var e=null;if(this.mode==="main"?e=(r=this.mainView.filteredActions[this.mainView.selectedIdx])==null?void 0:r.actions:e=(a=this.searchView.searchResults[this.searchView.selectedIdx])==null?void 0:a.actions,typeof e[t]>"u")return;const i=e[t];if(i.type==="link"){if(typeof i.url>"u")return;window.location=i.url;return}if(i.type==="search"){this.searchView.searchVal="",this.searchView.searchResults=[],this.searchView.isSearching=!1,this.searchView.searchUrl=i.url,this.mode="search",Vue.nextTick(()=>{document.getElementById("supersonic-filter").focus()});return}},clickAction(t){this.mode==="main"?(this.mainView.selectedIdx=t,this.doAction("primary")):(this.searchView.selectedIdx=t,this.doAction("primary"))}}};var Ae=function(){var e=this,i=e._self._c;return i("div",{directives:[{name:"show",rawName:"v-show",value:e.isVisible,expression:"isVisible"}],staticClass:"modal-container"},[i("div",{staticClass:"modal"},[i("h2",[e._v(e._s(e.__("Supersonic")))]),e.mode==="main"?i("div",[i("p",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.mainView.filterVal,expression:"mainView.filterVal"}],attrs:{type:"text",id:"supersonic-filter"},domProps:{value:e.mainView.filterVal},on:{input:function(r){r.target.composing||e.$set(e.mainView,"filterVal",r.target.value)}}})]),i("supersonic-action-list",{attrs:{actions:e.mainView.filteredActions,selectedIdx:e.mainView.selectedIdx},on:{clickAction:e.clickAction}}),i("supersonic-key-listener",{attrs:{isVisible:e.isVisible},on:{toggleVisibility:function(r){return e.toggleVisibility()},visibilityHide:function(r){return e.visibilityHide()},selectNext:function(r){return e.mainSelectNext()},selectPrevious:function(r){return e.mainSelectPrevious()},primaryAction:function(r){return e.doAction("primary")},secondaryAction:function(r){return e.doAction("secondary")},tertiaryAction:function(r){return e.doAction("tertiary")}}})],1):e._e(),e.mode==="search"?i("div",[i("p",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.searchView.searchVal,expression:"searchView.searchVal"}],attrs:{type:"text",id:"supersonic-filter"},domProps:{value:e.searchView.searchVal},on:{input:function(r){r.target.composing||e.$set(e.searchView,"searchVal",r.target.value)}}})]),!e.searchView.isSearching&&this.searchView.searchResults.length>0?i("supersonic-action-list",{attrs:{actions:e.searchView.searchResults,selectedIdx:e.searchView.selectedIdx},on:{clickAction:e.clickAction}}):e._e(),!e.searchView.isSearching&&this.searchView.searchResults.length<1?i("div",{staticClass:"no-results-container"},[!this.searchView.errorSearching&&this.searchView.searchVal.length<1?i("p",[e._v(" "+e._s(e.__("Type to search in "))+e._s(this.mainView.filteredActions[e.mainView.selectedIdx].path+" » "+this.mainView.filteredActions[e.mainView.selectedIdx].name)+" ")]):e._e(),!this.searchView.errorSearching&&this.searchView.searchVal.length>0?i("p",[e._v(" "+e._s(e.__("No results"))+" ")]):e._e(),this.searchView.errorSearching&&this.searchView.customErrorMessage.length<1?i("p",[e._v(" "+e._s(e.__("There was an error fetching results. Sorry."))+" ")]):e._e(),this.searchView.errorSearching&&this.searchView.customErrorMessage.length>0?i("p",[e._v(" "+e._s(e.searchView.customErrorMessage)+" ")]):e._e()]):e._e(),e.searchView.isSearching?i("div",{staticClass:"spinner-container"},[i("div",[e._m(0),i("p",[e._v(e._s(e.__("Searching...")))])])]):e._e(),i("supersonic-key-listener",{attrs:{isVisible:e.isVisible},on:{toggleVisibility:function(r){return e.toggleVisibility()},visibilityHide:function(r){return e.visibilityHide()},selectNext:function(r){return e.selectNextSearchResult()},selectPrevious:function(r){return e.selectPreviousSearchResult()},primaryAction:function(r){return e.doAction("primary")},secondaryAction:function(r){return e.doAction("secondary")},tertiaryAction:function(r){return e.doAction("tertiary")},backAction:function(r){return e.leaveSearchAction()}}})],1):e._e()])])},Te=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"lds-ring"},[e("div"),e("div"),e("div"),e("div")])}],ke=O(xe,Ae,Te,!1,null,"f3507b64",null,null);const je=ke.exports;const Ee={props:{actions:{type:Object,required:!0},selectedIdx:{type:Number,required:!0}},data(){return{}}};var Oe=function(){var e=this,i=e._self._c;return i("div",{staticClass:"list-container"},[i("ul",e._l(e.actions,function(r,a){return i("li",{class:"indent-"+r.depth+" "+(Number(a)===e.selectedIdx?"action-selected":""),attrs:{id:"action-"+a},on:{click:function(h){return e.$emit("clickAction",a)}}},[i("span",{staticClass:"action-icon",domProps:{innerHTML:e._s(r.svgIcon)}}),e._v(" "+e._s(r.name)+" "),i("span",{staticClass:"action-path"},[e._v(e._s(r.path))])])}),0)])},Re=[],Ce=O(Ee,Oe,Re,!1,null,"39e22802",null,null);const Le=Ce.exports,Ne={props:{isVisible:{type:Boolean,required:!0}},data(){return{}},mounted(){document.addEventListener("click",t=>{t.target.classList.contains("modal-container")&&this.$emit("visibilityHide")}),document.addEventListener("keydown",t=>{if(!(!t.target instanceof HTMLElement&&!t.target instanceof document)){if((t.metaKey||t.ctrlKey)&&t.code==="KeyK")return this.$emit("toggleVisibility"),t.preventDefault();if(t.code==="Escape")return this.$emit("visibilityHide"),t.preventDefault();if(this.isVisible){if(t.code==="ArrowDown")return this.$emit("selectNext"),t.preventDefault();if(t.code==="ArrowUp")return this.$emit("selectPrevious"),t.preventDefault();if(!(t.metaKey||t.ctrlKey)&&t.code==="Enter")return this.$emit("primaryAction"),t.preventDefault();if((t.metaKey||t.ctrlKey)&&t.code==="Enter")return this.$emit("secondaryAction"),t.preventDefault();if((t.metaKey||t.ctrlKey)&&t.code==="ArrowRight")return this.$emit("tertiaryAction"),t.preventDefault();if((t.metaKey||t.ctrlKey)&&t.code==="ArrowLeft")return this.$emit("backAction"),t.preventDefault()}}})}};var Me=function(){var e=this,i=e._self._c;return i("div")},Pe=[],Fe=O(Ne,Me,Pe,!1,null,null,null,null);const Be=Fe.exports;var E;class De{constructor(){R(this,E,void 0)}async init(){const e=await fetch("/cp/!/ademti-apps/supersonic/actions").then(i=>i.ok?i.json():{}).catch(()=>({}));this.data=await e}get(){return this.data}}E=new WeakMap;Statamic.booting(()=>{Statamic.$components.register("supersonic-app",je),Statamic.$components.register("supersonic-action-list",Le),Statamic.$components.register("supersonic-key-listener",Be)});const P=new De;async function F(){await P.init(),Statamic.$components.append("supersonic-app",{props:{actions:P.get(),isVisible:!1,mode:"main"}})}document.readyState!=="loading"?F():document.addEventListener("DOMContentLoaded",F);
